{% extends 'SmartkillWebBundle::layout.html.twig' %}

{% block title %}SmartKill - Mecze{% endblock %}

{% block javascripts %}
    {{ parent() }}
	<script type="text/javascript" src="http://maps.google.com/maps/api/js?language=en&sensor=false"></script>
    <script src="{{ asset('js/match.listing.js') }}" type="text/javascript"></script>
{% endblock %}

{% block content %}

	<div class="block">
		<a href="{{ path('match_add') }}" class="btn btn-primary btn-large pull-right">Zaplanuj nowy mecz</a>
		
		<h2>Planowane mecze</h2>
		
		<div class="alert alert-info">
			Poniższa lista prezentuje trwające oraz planowane w najbliższym czasie rogrywki.<br />
			<strong>Przejdź do szczegółów danego meczu, aby zapisać się do niego jako gracz.</strong>
		</div>
		
		<table class="table table-striped table-bordered">
			<colgroup span="1" />
			<colgroup span="1" width="80px" />
			<colgroup span="1" width="150px" align="center" />
			<colgroup span="2" width="60px" align="right" />
			<colgroup span="1" width="20px" align="center" />
			<colgroup span="1" width="110px" />
		    <thead>
		        <tr>
		            <th>Nazwa</th>
		            <th>Lokalizacja</th>
		            <th>Termin</th>
		            <th>Długość</th>
					<th><div rel="tooltip" title="Zapisanych / Maksymalnie">Graczy</div></th>
		            <th>Hasło</th>
		            <th></th>
		        </tr>
		    </thead>
		    <tbody>
		    {% for entity in pager.currentPageResults %}
		        <tr>
		            <td>{{ entity.name }}</td>
		            <td>
						<a href="#mapModal" role="button" class="btn btn-small btn-block mapModalBtn" 
							data-lat="{{ entity.lat }}"
							data-lng="{{ entity.lng }}"
							data-radius="{{ entity.size }}">
							<i class="icon-globe"></i> Mapa
						</a>
					</td>
		            <td>{{ entity.dueDate|date('Y-m-d H:i') }}</td>
		            <td>{{ entity.getLengthDesc }}</td>
		            <td>{{ entity.players.count }} / {{ entity.maxPlayers }}</td>
		            <td>{% if entity.password %}<i class="icon-ok"></i>{% endif %}</td>
		            <td><a class="btn btn-small btn-block" href="{{ path('match_show', { 'id': entity.id }) }}"><i class="icon-eye-open"></i> Szczegóły</a></td>
		        </tr>
		    {% endfor %}
		    </tbody>
		</table>
		
		{{ pagerfanta(pager) }}
		
		<div id="mapModal" class="modal hide fade" tabindex="-1" role="dialog" aria-hidden="true">
			<div class="modal-header">
				<button type="button" class="close" data-dismiss="modal" aria-hidden="true">×</button>
				<h3>Lokalizacja</h3>
				<span id="mapModalDesc"></span>
			</div>
			<div class="modal-body">
				<div id="map" class="map-canvas" style="height: 350px;"></div>
			</div>
		</div>
	</div>

{% endblock %}
